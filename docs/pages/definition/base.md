---
title: Базовые определения
sidebar: doc_sidebar
permalink: definitions.html
folder: definition
---

### Директория проекта
Директория проекта (project dir) — это директория, содержащая Dappfile.

### Имя проекта
Имя проекта — это последний элемент пути к git репозиторию из параметра конфигурации remote.origin.url или, при отсутствии git или параметра конфигурации remote.origin.url, это имя [директории проекта](#директория-проекта).

### Dappfile # TODO
Dappfile — это файл, содержащий инструкции по сборке docker образов.

### Dimg # TODO
Dimg (dimg) — это набор правил, объединенных в одном Dappfile, по которым происходит сборка образа.

### Артефакт # TODO
Артефакт (artifact) — это несамостоятельное [приложение](#приложение).

* Используется для изолирования процесса сборки (среды, программного обеспечение, данных) необходимых ресурсов от связанных приложений.
* Наследования от родителя происходит по тем же правилам, что и у [подприложения](#подприложение).
* Стадии артефакта практически полностью совпадают со стадиями приложения, но:
  * Отсутствуют:
    * git_artifact_post_setup_patch.
    * git_artifact_latest_patch.
    * docker_instructions.
  * Добавляются:
    * git_artifact_artifact_patch.
    * build_artifact.
* Могут использоваться такие же директивы, как у приложения, но с некоторыми особенностями:
  * [docker](docker_directives.html): не используются директивы применения dockerfile-инструкций.
  * [shell](shell_directives.html): добавляется директива [build_artifact](shell_directives.html#shell-build_artifact-<cmd>-<cmd>-cache_version-<cache_version>).
  * У артефакта не может быть потомков, поэтому отсутствуют директивы app и artifact.

### Стадия
Стадия (stage) — это именованный набор инструкций для сборки docker образа.

* Собранное приложение представляет собой цепочку связанных стадий.
* Имя docker образа стадии формируется по шаблону: dimgstage-\<[имя проекта](#имя-проекта)\>:\<[сигнатура стадии](#сигнатура-стадии)\>.

### Сигнатура стадии
Сигнатура стадии (signature) — это контрольная сумма правил сборки, зависимостей стадии и сигнатуры предыдущей стадии, если она существует.

* Изменение сигнатуры стадии ведет к её пересборке, а также последующих стадий.
* При отсутствии правил и зависимостей, стадия игнорируется, используется сигнатура предыдущей стадии.

### Кэш приложения
Набор docker-образов, который определяется [стадиями приложения](#стадия).

### Тип сборки # TODO
Dapp поддерживает 2 типа сборки: [chef приложение](chef.html#chef-приложение) и [shell приложение](#shell-проект).

* В одном [приложении](#приложение) может быть использован один тип сборки.
* Тип сборки определяется автоматически при первом использовании соответствующей инструкции в [Dappfile](#dappfile).

### Shell проект
Shell проект — это проект, для сборки которого используются команды bash, заданные в [Dappfile](#dappfile).

### Chef директория # TODO

### Директория сборки проекта
Директория сборки проекта (build dir) — это директория для хранения кэша и производных данных сборки [проекта](#проект).

* Используется для:
  * Хранения [дерева cookbooks](#дерево-cookbooks).
    * Этот результат при возможности кэшируется между сборками.
  * Кэширования [контрольных сумм cookbook\`ов стадий](#контрольная-сумма-cookbookов-стадии).
  * Хранения файлов блокировок проекта.
* Путь к build директории.
  * По умолчанию: \<[директория проекта](#директория-проекта)\>/.dapps_build.
  * Переопределяется параметром --build-dir.
* Необходимо указывать одну и ту же build директорию для каждой из вызываемых команд dapp (или использовать путь к директории по умолчанию).
* При указании build директории необходимо иметь в виду, что для каждого [проекта](#проект) нужна отдельная директория.
* Одна и та же build директория используется всеми [приложениями](#приложение), описанными в данном [проекте](#проект).

### Временная директория приложения
Временная директория приложения (tmp dir) — это временная рабочая директория сборщика [приложения](#приложение).

* Создается для каждого [приложения](#приложение) во время сборки.
* Используется для хранения:
  * Склонированных remote git репозиториев.
  * [Стадий cookbook\`ов](#стадия-cookbookа), [установленных](#установка-стадии-cookbookа) для сборки стадии.
* Путь к директории: /tmp/dapp-\<date\>-\<random\>.
* Удаление директории происходит автоматически при ожидаемом успешном или не успешном завершении работы dapp.

### Режим разработки
* Включается опцией командной строки --dev.
* Используется для:
  * включения создания файла Berksfile.lock в случае его отсутствия (см. [cookbook приложения](#cookbook-приложения)).

### Блокировка ресурса
Блокировки обеспечивают корректную работу команд dapp при их параллельном запуске в рамках одного проекта на одном сервере.

* Блокировки реализованы с использованием механизма файловых блокировок ОС.
* Файлы блокировок хранятся в директории \<[build dir](#директория-сборки)\>/locks.

### Внешняя директория сборки # TODO
Директория, которая монтируется в docker-контейнеры в процессе сборки [приложения](#приложение).

* Используется для уменьшения размера [кэша приложения](#кэш-приложения) и конечного образа приложения соответственно.
* Ожидается директория с данными порождаемыми в процессе сборки, которые:
  * не требуются конечному пользователю;
  * занимают значительный размер.
* Для добавления используются директивы [tmp_dir](base_directives.html#tmp_dir-<dir>-dir) и [build_dir](base_directives.html#build_dir-<dir>-dir), которые различаются местом размещения внешней директории. 

### Scratch образ # TODO
Пустой docker образ, используемый в качестве окружения приложения по умолчанию, если пользователь не указал его ([docker.from](docker_directives.html#docker-from-<image>-cache_version-<cache_version>)).