---
title: Выбор базового образа
sidebar: doc_sidebar
permalink: choose_base_image.html
folder: directive
---

Мы можем указывать базовый образ, на основе которого производится сборка.

Поддержка сборщиками

- Shell - нет
- Chef - да
- Ansible - нет

# Решение

## Ansible-сборщик

@todo: описать

## Chef-сборщик

Директива `dimg <name>` указывает базовый образ. Обратите внимание, что 

* В одном Dappfile может быть только один безымянный образ.
* Можно определять несколько образов в одном Dappfile.
* На верхнем уровне могут использоваться только директивы dimg и dimg\_group.
* Часть директив имеют несколько возможных форм записи.
* Наследуются все настройки родительского контекста.
* Можно дополнять или переопределять настройки родительского контекста.

### Собирать образ, не указывая имени
```ruby
dimg do
  docker.from 'image:tag'
end
```

### Собирать образы X и Y
```ruby
dimg 'X' do
  docker.from 'image1:tag'
end

dimg 'Y' do
  docker.from 'image2:tag'
end
```

### Создавать контексты для сборки

При сборке можно использовать контексты с помощью директивы dimg\_group. Их можно в том числе вкладывать друг в друга:

```ruby
dimg_group do
  docker.from 'image:tag'

  dimg 'X'

  dimg_group do
    dimg 'Y'

    dimg_group do
      dimg 'Z'
    end
  end
end
```
